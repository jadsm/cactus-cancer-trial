d2<-d2[d2$`Dab dispensed date`!="8888-88-88",c("PID","Dab dispensed date")]
orig.df<-merge(orig.df,d2,by=c("PID"),all.x=T,all.y=F)
d11<-read.csv("../Data/CSV_export/CAcTUS.Table 11.csv")
colnames(d11)<-d11[1,]
d11<-d11[-1,]
d11<-d11[d11$`Treatment cycle`=="01|Cycle 01",c("PID","Visit date (Immune)")]
orig.df<-merge(orig.df,d11,by=c("PID"),all.x=T,all.y=F)
orig.df$`Baseline visit date`[orig.df$Firstlinetreatment=="Targeted" & is.na(orig.df$`Baseline visit date`)]<-
orig.df$`Dab dispensed date`[orig.df$Firstlinetreatment=="Targeted" & is.na(orig.df$`Baseline visit date`)]
orig.df$`Baseline visit date`[orig.df$Firstlinetreatment=="IO"]<-
orig.df$`Visit date (Immune)`[orig.df$Firstlinetreatment=="IO"]
orig.df<-orig.df[,c(1:23)]
orig.df$`Baseline visit date`<-as.Date(orig.df$`Baseline visit date`,"%d/%m/%Y")
orig.df$Days2<-as.numeric(orig.df$`Sample Date`-orig.df$`Baseline visit date`)
orig.df<-arrange(orig.df,PID,Days)
# patients 21, 5 and 8 don't have a 0 time
seq(1,21,by=1)[!(seq(1,21,by=1) %in% as.numeric(unique(orig.df$PID[orig.df$Days2==0])))]
orig.df[orig.df$PID==5,c("Visit","Days2")]
orig.df$Days2[orig.df$PID==5 & orig.df$Visit=="Screening"]<-0
orig.df[orig.df$PID==8,c("Visit","Days2")]
orig.df$Days2[orig.df$PID==8]<-orig.df$Days2[orig.df$PID==8]+1
orig.df[orig.df$PID==21,c("Visit","Days2")]
orig.df$Days2[orig.df$PID==21 & orig.df$Visit=="Screening"]<-0
# patient 9 was teh odd one with screening/baseline issue
orig.df[orig.df$PID==9,c("Visit","Percentage Mutant VAF","Days2")]
# we will remove the baseline and use screening values
orig.df$Days2[orig.df$PID==9 & orig.df$Visit=="Baseline"]<- -15
orig.df$Days2[orig.df$PID==9 & orig.df$Visit=="Screening"]<- 0
# quick plot...
ggplot(orig.df,aes(Days2,`Percentage Mutant VAF`,group=PID,col=Firstlinetreatment))+
geom_line(alpha=0.5)+xlim(0,63)+facet_wrap(~Firstlinetreatment)
for (ii in 2:length(orig.df$PID)){
if (orig.df$PID[ii]==orig.df$PID[ii-1] & orig.df$`Sample Date`[ii]==orig.df$`Sample Date`[ii-1]){
orig.df$`Percentage Mutant VAF`[ii]<-(orig.df$`Percentage Mutant VAF`[ii]+
orig.df$`Percentage Mutant VAF`[ii-1])/2
orig.df$`Percentage Mutant VAF`[ii-1]<-orig.df$`Percentage Mutant VAF`[ii]
}
}
colnames(orig.df)
orig.df<-unique(orig.df[,c(1,3,4,7,17,18,19,21:24)])
# quick plot...
ggplot(orig.df,aes(Days2,`Percentage Mutant VAF`,group=PID,col=Firstlinetreatment))+
geom_line(alpha=0.5)+xlim(0,63)+facet_wrap(~Firstlinetreatment)
# now we have a ctDNA data-set we can work with
dummy<-orig.df[orig.df$Days2==0,c("PID","Percentage Mutant VAF")]
colnames(dummy)[2]<-"BSL"
orig.df<-merge(orig.df,dummy,by=c("PID"),all.x=T,all.y=T)
orig.df$CHG<-orig.df$`Percentage Mutant VAF`-orig.df$BSL
orig.df$PCHG<-100*orig.df$CHG/orig.df$BSL
orig.df<-orig.df[orig.df$Days2>=0,]
orig.df$ARM[orig.df$ARM=="01|ARM A"]<-"ARM A"
orig.df$ARM[orig.df$ARM=="02|ARM B"]<-"ARM B"
ggplot(orig.df,aes(Days2,`Percentage Mutant VAF`,group=PID,col=ARM))+
geom_line(alpha=0.7)+facet_wrap(~ARM)+
ylab("Mutant VAF [%]")+
theme_bw(base_size = 14)+
xlab("Days from Baseline")+
scale_color_manual(values = c("ARM A" = "#FFA500", "ARM B" = "#008000"))
ggplot(orig.df,aes(Days2,`Percentage Mutant VAF`,group=PID,col=ARM))+
geom_line(alpha=0.7)+facet_wrap(~ARM)+
ylab("Mutant VAF [%]")+
theme_bw(base_size = 14)+
xlab("Days from Baseline")+
scale_color_manual(values = c("ARM A" = "#FFA741", "ARM B" = "#3684BC"))
ggplot(orig.df,aes(Days2,PCHG,group=PID,col=ARM))+
geom_line(alpha=0.7)+facet_wrap(~ARM)+
ylab("% Change from Baseline Mutant VAF")+
theme_bw(base_size = 14)+
xlab("Days from Baseline")+
geom_hline(yintercept = -80,lty=2,col=1)+
scale_color_manual(values = c("ARM A" = "#FFA741", "ARM B" = "#3684BC"))
ggplot(orig.df[orig.df$Firstlinetreatment==orig.df$Treatment,],aes(Days2,PCHG,group=PID,col=Firstlinetreatment))+
geom_line(alpha=0.5)+facet_wrap(~Firstlinetreatment)+
geom_hline(yintercept = -80,lty=2)+
ylab("% Change from Baseline Mutant VAF")+
scale_y_continuous(breaks=seq(-100,50,by=20),lim=c(-100,50))+
scale_x_continuous(breaks=seq(0,63,by=7),lim=c(0,63))+
theme_bw(base_size = 14)+
xlab("Days from Baseline")+
scale_color_manual(values = c("Targeted" = "#087383", "IO" = "#F37B6A"))
View(orig.df)
dummy<-orig.df[orig.df$Firstlinetreatment==orig.df$Treatment,]
dummy$KEEP<-1
dummy
dummy
dummy$PCHG[dummy$PID==18]
dummy$KEEP[dummy$PID==18][(3:10)]
dummy$KEEP[dummy$PID==18][(3:10)]<-0
ggplot(dummy[dummy$KEEP==1,],
aes(Days2,PCHG,group=PID,col=Firstlinetreatment))+
geom_line(alpha=0.5)+facet_wrap(~Firstlinetreatment)+
geom_hline(yintercept = -80,lty=2)+
ylab("% Change from Baseline Mutant VAF")+
scale_y_continuous(breaks=seq(-100,50,by=20),lim=c(-100,50))+
scale_x_continuous(breaks=seq(0,63,by=7),lim=c(0,63))+
theme_bw(base_size = 14)+
xlab("Days from Baseline")+
scale_color_manual(values = c("Targeted" = "#087383", "IO" = "#F37B6A"))
View(dummy)
dummy
dummy
dummy<-orig.df[orig.df$Firstlinetreatment==orig.df$Treatment,]
first_below_80 <- which(dummy$PCHG < -80)[1]
dummy <- dummy[1:first_below_80, ]
dummy<-orig.df[orig.df$Firstlinetreatment==orig.df$Treatment,]
dummy <- dummy %>%
group_by(PID) %>%
filter(row_number() <= which(PCHG < -80)[1])
ggplot(dummy,
aes(Days2,PCHG,group=PID,col=Firstlinetreatment))+
geom_line(alpha=0.5)+facet_wrap(~Firstlinetreatment)+
geom_hline(yintercept = -80,lty=2)+
ylab("% Change from Baseline Mutant VAF")+
scale_y_continuous(breaks=seq(-100,50,by=20),lim=c(-100,50))+
scale_x_continuous(breaks=seq(0,63,by=7),lim=c(0,63))+
theme_bw(base_size = 14)+
xlab("Days from Baseline")+
scale_color_manual(values = c("Targeted" = "#087383", "IO" = "#F37B6A"))
View(dummy)
View(orig.df)
ggplot(dummy,
aes(Days2,PCHG,group=PID,col=Firstlinetreatment))+
geom_line(alpha=0.5)+facet_wrap(~Firstlinetreatment)+
geom_hline(yintercept = -80,lty=2)+
ylab("% Change from Baseline Mutant VAF")+
scale_y_continuous(breaks=seq(-100,50,by=20),lim=c(-100,50))+
scale_x_continuous(breaks=seq(0,63,by=7),lim=c(0,63))+
theme_bw(base_size = 14)+
xlab("Days from Baseline")+
scale_color_manual(values = c("Targeted" = "#087383", "IO" = "#F37B6A"))
orig.df$PID<-as.numeric(orig.df$PID)
orig.df<-arrange(orig.df,PID,Days2)
# lets assess time to reach <-80
result <- orig.df[orig.df$PCHG <= -80, ]
result <- result[!duplicated(result$PID), c("PID", "Days2","ARM","Firstlinetreatment")]
summary(result$Days2[result$ARM=="ARM B"])
summary(result$Days2[result$ARM=="ARM A" & result$Firstlinetreatment=="Targeted"])
summary(result$Days2[result$ARM=="ARM A" & result$Firstlinetreatment=="IO"])
# we now need to create visits - we already have them though...
orig.df$Visit
orig.df$VisitNew<-NA
orig.df$VisitNew[orig.df$Days2==0]<-1
orig.df$VisitNew[orig.df$Visit=="D+T Week 2" & orig.df$Firstlinetreatment=="Targeted"|
orig.df$Visit=="N+I C2D1" & orig.df$Firstlinetreatment=="IO"]<-2
orig.df$VisitNew[orig.df$Visit=="D+T Week 4" & orig.df$Firstlinetreatment=="Targeted"|
orig.df$Visit=="N+I C3D1" & orig.df$Firstlinetreatment=="IO"]<-3
orig.df$VisitNew[orig.df$Visit=="D+T Week 8" & orig.df$Firstlinetreatment=="Targeted"|
orig.df$Visit=="N+I C4D1" & orig.df$Firstlinetreatment=="IO"]<-4
sum(orig.df$VisitNew==2,na.rm=T)
require(EnvStats)
ggplot(orig.df[orig.df$Firstlinetreatment==orig.df$Treatment & is.na(orig.df$VisitNew)==F,])+
geom_line(aes(VisitNew,PCHG,group=PID,col=Firstlinetreatment),alpha=0.1)+facet_wrap(~Firstlinetreatment)+
geom_hline(yintercept = -80,lty=2)+
ylab("% Change from Baseline Mutant VAF")+
scale_y_continuous(breaks=seq(-100,50,by=20),lim=c(-110,50))+
scale_x_continuous(breaks=seq(1,4,by=1),lim=c(1,4))+
theme_bw(base_size = 14)+
xlab("Visit")+
scale_color_manual(values = c("Targeted" = "#0000FF", "IO" = "#FF0000"))+
stat_summary(fun = median,  aes(x=VisitNew,y=PCHG,group = VisitNew,col=Firstlinetreatment)) +  # Median line
stat_summary(fun.data = function(y) {  # IQR bars
return(data.frame(y = median(y), ymin = quantile(y, 0.25), ymax = quantile(y, 0.75)))
},  aes(x=VisitNew,y=PCHG,group = VisitNew,col=Firstlinetreatment),
geom = "errorbar", width = 0.2, size = 1)+
stat_summary(fun = median,  aes(x=VisitNew,y=PCHG,col=Firstlinetreatment),geom="line")+
stat_n_text(aes(x=VisitNew,y=PID),y.pos = -110)
ggplot(orig.df[orig.df$Firstlinetreatment==orig.df$Treatment & is.na(orig.df$VisitNew)==F,])+
geom_line(aes(VisitNew,`Percentage Mutant VAF`,group=PID,col=Firstlinetreatment),alpha=0.1)+facet_wrap(~Firstlinetreatment)+
ylab("Mutant VAF [%]")+
scale_x_continuous(breaks=seq(1,4,by=1),lim=c(1,4))+
theme_bw(base_size = 14)+
xlab("Visit")+
scale_color_manual(values = c("Targeted" = "#087383", "IO" = "#F37B6A"))+
stat_summary(fun = median,  aes(x=VisitNew,y=`Percentage Mutant VAF`,group = VisitNew,col=Firstlinetreatment)) +  # Median line
stat_summary(fun.data = function(y) {  # IQR bars
return(data.frame(y = median(y), ymin = quantile(y, 0.25), ymax = quantile(y, 0.75)))
},  aes(x=VisitNew,y=`Percentage Mutant VAF`,group = VisitNew,col=Firstlinetreatment),
geom = "errorbar", width = 0.2, size = 1)+
stat_summary(fun = median,  aes(x=VisitNew,y=`Percentage Mutant VAF`,col=Firstlinetreatment),geom="line")+
stat_n_text(aes(x=VisitNew,y=PID),y.pos = -10)
d7<-read.csv("../Data/CSV_export/CAcTUS.Table 7.csv")
colnames(d7)<-d7[1,]
require(EnvStats)
ggplot(orig.df[orig.df$Firstlinetreatment==orig.df$Treatment & is.na(orig.df$VisitNew)==F,])+
geom_line(aes(VisitNew,PCHG,group=PID,col=Firstlinetreatment),alpha=0.1)+facet_wrap(~Firstlinetreatment)+
geom_hline(yintercept = -80,lty=2)+
ylab("% Change from Baseline Mutant VAF")+
scale_y_continuous(breaks=seq(-100,50,by=20),lim=c(-110,50))+
scale_x_continuous(breaks=seq(1,4,by=1),lim=c(1,4))+
theme_bw(base_size = 14)+
xlab("Visit")+
scale_color_manual(values = c("Targeted" = "#087383", "IO" = "#F37B6A"))+
stat_summary(fun = median,  aes(x=VisitNew,y=PCHG,group = VisitNew,col=Firstlinetreatment)) +  # Median line
stat_summary(fun.data = function(y) {  # IQR bars
return(data.frame(y = median(y), ymin = quantile(y, 0.25), ymax = quantile(y, 0.75)))
},  aes(x=VisitNew,y=PCHG,group = VisitNew,col=Firstlinetreatment),
geom = "errorbar", width = 0.2, size = 1)+
stat_summary(fun = median,  aes(x=VisitNew,y=PCHG,col=Firstlinetreatment),geom="line")+
stat_n_text(aes(x=VisitNew,y=PID),y.pos = -110)
ggplot(orig.df[orig.df$Firstlinetreatment==orig.df$Treatment & is.na(orig.df$VisitNew)==F,])+
geom_line(aes(VisitNew,`Percentage Mutant VAF`,group=PID,col=Firstlinetreatment),alpha=0.1)+facet_wrap(~Firstlinetreatment)+
ylab("Mutant VAF [%]")+
scale_x_continuous(breaks=seq(1,4,by=1),lim=c(1,4))+
theme_bw(base_size = 14)+
xlab("Visit")+
scale_color_manual(values = c("Targeted" = "#087383", "IO" = "#F37B6A"))+
stat_summary(fun = median,  aes(x=VisitNew,y=`Percentage Mutant VAF`,group = VisitNew,col=Firstlinetreatment)) +  # Median line
stat_summary(fun.data = function(y) {  # IQR bars
return(data.frame(y = median(y), ymin = quantile(y, 0.25), ymax = quantile(y, 0.75)))
},  aes(x=VisitNew,y=`Percentage Mutant VAF`,group = VisitNew,col=Firstlinetreatment),
geom = "errorbar", width = 0.2, size = 1)+
stat_summary(fun = median,  aes(x=VisitNew,y=`Percentage Mutant VAF`,col=Firstlinetreatment),geom="line")+
stat_n_text(aes(x=VisitNew,y=PID),y.pos = -10)
# load libraries
library(tidyverse)  # read and elaborate data
library(haven)      # read .dta files
library(lubridate)  # operations on dates
library(ggplot2)
library(survminer)
library(survival)
library(dplyr)
# we will go through each table and select what we need
d1<-read.csv("../Data/CSV_export/CAcTUS.Table 1.csv")
colnames(d1)<-d1[1,]
d1<-d1[-1,]
colnames(d1)
# this data-set tells us the eligibility of patients to the trial
# from this file one can see who got onto the trail and reasons why others
# were not recruited - this is the file that would be sued to create the consort
# our interest is in only those that entered the study
d1$`failed Inc number`[d1$`Eligible for study`=="00|No"]
d1$`Failed Ex number`[d1$`Eligible for study`=="00|No"]
# interestingly all had ctDNA measurements
d1$`BRAF VAF ctDNA result`
# 888.88 are NA
d1$`BRAF VAF ctDNA result`[d1$`BRAF VAF ctDNA result`=="888.88"]<-NA
d1
d1$`If no reason ctDNA BRAF VAF less 5`[d1$`Eligible for study`=="00|No"]
# so quite a few were rejected due to VAF levels being too low so <5%
d1$`If no reason ctDNA BRAF VAF less 5`[is.na(d1$`BRAF VAF ctDNA result`)]
# so teh two who did not have ctDNA the reason for not including was not ctDNA
d1$`failed Inc number`[is.na(d1$`BRAF VAF ctDNA result`)]
d1$`BRAF VAF ctDNA result`<-as.numeric(d1$`BRAF VAF ctDNA result`)
d1[,c("PID","BRAF VAF ctDNA result")]
d1$`Date result received by Investigator`[d1$`Date result received by Investigator`=="8888-88-88"]<-NA
d1$`Date result received by Investigator`<-as.Date(d1$`Date result received by Investigator`, "%d/%m/%Y")
ggplot(d1,aes(`Date result received by Investigator`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_point()+
theme_bw(base_size=14)+scale_y_log10()+ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)
ggplot(d1,aes(`Eligible for study`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_jitter()+
theme_bw(base_size=14)+scale_y_log10()+ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)
# Plotting Cumulative Density
ggplot(d1, aes(x = `BRAF VAF ctDNA result`)) +
stat_ecdf(geom = "step", pad = FALSE) + # pad=FALSE ensures the plot starts at the first data point
theme_bw(base_size=14) +
labs(x = "BRAF VAF ctDNA [%]",
y = "Cumulative Fraction")+
scale_x_log10(breaks=c(0.1,0.2,0.5,1.5,5,10,100),lim=c(0.05,100))+
scale_y_continuous(breaks=c(seq(0,1,by=0.1)))
d1$`failed Inc number`[d1$`Eligible for study`=="00|No" &
d1$`ctDNA blood sample taken`=="01|Yes"]
# 5 had organ function issues
d1$`BRAF VAF ctDNA result`[d1$`Eligible for study`=="00|No" &
c(is.na(d1$`failed Inc number`))]
# the 9 NAs all had ctDNA<1.5
d1$`BRAF VAF ctDNA result`[d1$`Eligible for study`=="00|No" &
c(is.na(d1$`failed Inc number`)==F &
c(d1$`failed Inc number`=="8"|
d1$`failed Inc number`=="INCLUSION #8"|
d1$`failed Inc number`=="NO.8"))]
# those numbered as ctDNA failures 2 did have ctDNA >1.5
d1$`BRAF VAF ctDNA result`[d1$`Eligible for study`=="00|No" &
c(is.na(d1$`failed Inc number`)==F &
c(d1$`failed Inc number`=="9"|
d1$`failed Inc number`=="INCLUSION 9"|
d1$`failed Inc number`=="9 CARDIAC LVEF"|
d1$`failed Inc number`=="INCLUSION CRITERIA 9"))]
d1$`BRAF VAF ctDNA result`[d1$`Eligible for study`=="00|No" &
c(is.na(d1$`failed Inc number`))]
# we shall now keep the 21
d1<-d1[d1$`Eligible for study`=="01|Yes",]
ggplot(d1,aes(`Date result received by Investigator`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_point()+
theme_bw(base_size=14)+scale_y_log10()+ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)
ggplot(d1,aes(`Eligible for study`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_jitter()+
theme_bw(base_size=14)+scale_y_log10()+ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)
# Plotting Cumulative Density
ggplot(d1, aes(x = `BRAF VAF ctDNA result`)) +
stat_ecdf(geom = "step", pad = FALSE) + # pad=FALSE ensures the plot starts at the first data point
theme_bw(base_size=14) +
labs(x = "BRAF VAF ctDNA [%]",
y = "Cumulative Fraction")+
scale_x_log10(breaks=c(0.1,0.2,0.5,1.5,5,10,100),lim=c(0.05,100))+
scale_y_continuous(breaks=c(seq(0,1,by=0.1)))
# load libraries
library(tidyverse)  # read and elaborate data
library(haven)      # read .dta files
library(lubridate)  # operations on dates
library(ggplot2)
library(survminer)
library(survival)
library(dplyr)
# This script will go through collection of baseline characteristics
# and do the plots relating to the primary end-point around
# ctDNA and the KM plots as per the secondary analysis
# Demographics -----------------------------------------------------------
# we will go through each table and select what we need
d1<-read.csv("../Data/CSV_export/CAcTUS.Table 1.csv")
colnames(d1)<-d1[1,]
d1<-d1[-1,]
colnames(d1)
# this data-set tells us the eligibility of patients to the trial
# from this file one can see who got onto the trail and reasons why others
# were not recruited - this is the file that would be sued to create the consort
# our interest is in only those that entered the study
d1$`failed Inc number`[d1$`Eligible for study`=="00|No"]
d1$`Failed Ex number`[d1$`Eligible for study`=="00|No"]
# patients were excluded mainly due to failure on inclusion criteria and reasons
# were criteria 8 and 9 - from protocol:
# 8.	Screening ctDNA (as defined by the mutant BRAF VAF in plasma) â‰¥1.5%
# apparently it started off with 5% and then changed to 1.5%
# 9.	Adequate organ function (see table 2.)
# interestingly all had ctDNA measurements
d1$`BRAF VAF ctDNA result`
# 888.88 are NA
d1$`BRAF VAF ctDNA result`[d1$`BRAF VAF ctDNA result`=="888.88"]<-NA
d1
d1$`If no reason ctDNA BRAF VAF less 5`[d1$`Eligible for study`=="00|No"]
# so quite a few were rejected due to VAF levels being too low so <5%
d1$`If no reason ctDNA BRAF VAF less 5`[is.na(d1$`BRAF VAF ctDNA result`)]
# so teh two who did not have ctDNA the reason for not including was not ctDNA
d1$`failed Inc number`[is.na(d1$`BRAF VAF ctDNA result`)]
d1$`BRAF VAF ctDNA result`<-as.numeric(d1$`BRAF VAF ctDNA result`)
d1[,c("PID","BRAF VAF ctDNA result")]
d1$`Date result received by Investigator`[d1$`Date result received by Investigator`=="8888-88-88"]<-NA
d1$`Date result received by Investigator`<-as.Date(d1$`Date result received by Investigator`, "%d/%m/%Y")
ggplot(d1,aes(`Date result received by Investigator`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_point()+
theme_bw(base_size=14)+scale_y_log10()+ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)
ggplot(d1,aes(`Date result received by Investigator`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_point()+
theme_bw(base_size=14)+scale_y_log10()+ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)+
scale_y_continuous(breaks=c(0.1,0.5,1,1.5,5,10,30))
ggplot(d1,aes(`Date result received by Investigator`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_point()+
theme_bw(base_size=14)+scale_y_log10()+ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)+
scale_y_continuous(breaks=c(0.1,1,1.5,5,10,30))
ggplot(d1,aes(`Date result received by Investigator`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_point()+
theme_bw(base_size=14)+scale_y_log10(breaks=c(0.1,1,1.5,5,10,30))+
ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)
ggplot(d1,aes(`Date result received by Investigator`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_point()+
theme_bw(base_size=14)+scale_y_log10(breaks=c(0.1,1,1.5,5,10,30))+
ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)+
scale_color_manual(
name = "Study Eligibility",  # Legend title
labels = c("Eligible", "Not Eligible")  # Custom labels
)
ggplot(d1,aes(`Date result received by Investigator`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_point()+
theme_bw(base_size=14)+scale_y_log10(breaks=c(0.1,1,1.5,5,10,30))+
ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)+
scale_color_manual(
name = "Study Eligibility"
)
ggplot(d1,aes(`Date result received by Investigator`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_point()+
theme_bw(base_size=14)+scale_y_log10(breaks=c(0.1,1,1.5,5,10,30))+
ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)+
scale_color_manual(
name = "Study Eligibility",  # Legend title
labels = c("Eligible", "Not Eligible"),  # Custom labels
values = c("blue", "red")  # Specify colors
)
ggplot(d1,aes(`Date result received by Investigator`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_point()+
theme_bw(base_size=14)+scale_y_log10(breaks=c(0.1,1,1.5,5,10,30))+
ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)+
scale_color_manual(
name = "Study Eligibility",  # Legend title
labels = c("Note Eligible", "Eligible"),  # Custom labels
values = c("red", "blue")  # Specify colors
)
ggplot(d1,aes(`Date result received by Investigator`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_point()+
theme_bw(base_size=14)+scale_y_log10(breaks=c(0.1,1,1.5,5,10,30))+
ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)+
scale_color_manual(
name = "Study Eligibility",  # Legend title
labels = c("Not Eligible", "Eligible"),  # Custom labels
values = c("red", "blue")  # Specify colors
)
ggplot(d1,aes(`Eligible for study`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_jitter()+
theme_bw(base_size=14)+scale_y_log10()+ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)
ggplot(d1,aes(`Eligible for study`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_jitter()+
theme_bw(base_size=14)+scale_y_log10()+ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)+
scale_color_manual(
name = "Study Eligibility",  # Legend title
labels = c("Not Eligible", "Eligible"),  # Custom labels
values = c("red", "blue")  # Specify colors
)
ggplot(d1,aes(`Eligible for study`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_jitter()+
theme_bw(base_size=14)+scale_y_log10()+ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)+
scale_color_manual(
name = "Study Eligibility",  # Legend title
labels = c("No", "Yes"),  # Custom labels
values = c("red", "blue")  # Specify colors
)
ggplot(d1,aes(`Eligible for study`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_jitter()+
theme_bw(base_size=14)+scale_y_log10(breaks=c(0.1,1,1.5,5,10,30))+ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)+
scale_color_manual(
name = "Study Eligibility",  # Legend title
labels = c("No", "Yes"),  # Custom labels
values = c("red", "blue")  # Specify colors
)
ggplot(d1,aes(`Date result received by Investigator`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_point()+
theme_bw(base_size=14)+scale_y_log10(breaks=c(0.1,1,1.5,5,10,30))+
ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)+
scale_color_manual(
name = "Eligible for Study",  # Legend title
labels = c("No", "Yes"),  # Custom labels
values = c("red", "blue")  # Specify colors
)
ggplot(d1,aes(`Eligible for study`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_jitter()+
theme_bw(base_size=14)+scale_y_log10(breaks=c(0.1,1,1.5,5,10,30))+ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)+
scale_color_manual(
name = "Study Eligibility",  # Legend title
labels = c("No", "Yes"),  # Custom labels
values = c("red", "blue")  # Specify colors
)
ggplot(d1,aes(`Eligible for study`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_jitter()+
theme_bw(base_size=14)+scale_y_log10(breaks=c(0.1,1,1.5,5,10,30))+ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)+
scale_color_manual(
name = "Study Eligibility",  # Legend title
labels = c("No", "Yes"),  # Custom labels
values = c("red", "blue")  # Specify colors
)+
scale_x_discrete(
labels = c("No", "Yes")  # Custom x-axis labels
)
ggplot(d1,aes(`Eligible for study`,`BRAF VAF ctDNA result`,
col=`Eligible for study`))+geom_jitter()+
theme_bw(base_size=14)+scale_y_log10(breaks=c(0.1,1,1.5,5,10,30))+ylab("BRAF VAF ctDNA [%]")+
geom_hline(yintercept = 1.5,col=1,lty=2)+
geom_hline(yintercept = 5,col=1,lty=3)+
scale_color_manual(
name = "Study Eligibility",  # Legend title
labels = c("No", "Yes"),  # Custom labels
values = c("red", "blue")  # Specify colors
)+
scale_x_discrete(
labels = c("No", "Yes")  # Custom x-axis labels
)+
theme(legend.position = "none")  # Remove the legend
# Plotting Cumulative Density
ggplot(d1, aes(x = `BRAF VAF ctDNA result`)) +
stat_ecdf(geom = "step", pad = FALSE) + # pad=FALSE ensures the plot starts at the first data point
theme_bw(base_size=14) +
labs(x = "BRAF VAF ctDNA [%]",
y = "Cumulative Fraction")+
scale_x_log10(breaks=c(0.1,0.2,0.5,1.5,5,10,100),lim=c(0.05,100))+
scale_y_continuous(breaks=c(seq(0,1,by=0.1)))
